# COVID-19 Data Analysis with Apache Spark

## Описание
В данной работе выполнен анализ датасета по заболеваемости COVID-19 с использованием Apache Spark и DataFrame API.  
Цель работы — изучить структуру данных и получить практические навыки обработки и агрегации данных в Spark.

## Используемые инструменты
- Apache Spark (PySpark)
- Python 3
- DataFrame API

## Источник данных
Официальный датасет по COVID-19, содержащий информацию по странам, датам, числу заболевших и демографическим показателям.

## Выполненные задания

### 1. Топ-15 стран по проценту переболевших на 31 марта 2021
Для даты 31.03.2021 рассчитан процент переболевших как отношение общего числа случаев к населению страны.  
Результат отсортирован по убыванию, выбраны 15 стран с максимальным значением.

**Используемые колонки:**
- `iso_code`
- `location`
- `total_cases`
- `population`

---

### 2. Топ-10 стран по числу новых случаев за последнюю неделю марта 2021
Произведена агрегация количества новых случаев за период с 25 по 31 марта 2021 года.  
Результат отсортирован по убыванию суммарного числа новых случаев.

**Используемые колонки:**
- `date`
- `location`
- `new_cases`

---

### 3. Изменение числа новых случаев в России за последнюю неделю марта 2021
Для России рассчитано дневное изменение количества новых случаев относительно предыдущего дня
с использованием оконной функции `lag`.

**Результирующие колонки:**
- `date`
- `yesterday_cases`
- `new_cases`
- `delta`

---

## Запуск
1. Убедиться, что Apache Spark установлен и доступен в окружении
2. Поместить файл `covid-data.csv` в директорию со скриптом
3. Запустить команду:
   ```bash
   spark-submit covid_analysis.py
